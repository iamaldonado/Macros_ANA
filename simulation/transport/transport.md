### Macro for transport

To start the simulation process we require the macros **runMC.C**, **commonFunctions.C** and **geometry_stage1.C** located in the folder [macros/common](https://git.jinr.ru/nica/mpdroot/-/blob/dev/macros/common/). If they are in the same folder we just need to run it writing in the terminal:

> root -b -q runMC.C

This is going to get us the file **evetest.root**, with 2 events generated with BOX and transported with Geant3. To modify this default parameters, we need to know the structure of this macro and modify where is required.

 * 1. Options in the macro [runMC.C](https://git.jinr.ru/nica/mpdroot/-/blob/dev/macros/common/runMC.C): In the definition of the function,

```ruby
void runMC(EGenerators generator = EGenerators::BOX, EVMCType vmc = EVMCType::GEANT3, Int_t nStartSeed = 0,
           TString inFile = "auau.04gev.0_3fm.10k.f14.gz", TString outFile = "evetest.root", Int_t nStartEvent = 0,
           Int_t nEvents = 2, Bool_t flag_store_FairRadLenPoint = kFALSE, Int_t FieldSwitcher = 0)
```
you can change the options
 - the generator to be used replacing **BOX** for any of the availables
```ruby
enum EGenerators
{
   BOX = 1,
   FLUID,
   HSD,
   ION,
   LAQGSM,
   MCDST,
   PART,
   SMASH,
   UNIGEN,
   URQMD,
   VHLLE
};
```
 - The transport package Geant3 or Geant 4
 - The input File **inFile** according with your generated data, for default appears a file from UrQMD generator **auau.04gev.0_3fm.10k.f14.gz**, even is not used for BOX generator.
 - The output file **outFile** with MC data, by default: evetest.root 
 - **nStartEvent**, first event in the file to be analyzed
 - **nEvents**, the number of events to be transported, for example the number of events in inFile
 - **flag_store_FairRadLenPoint** to  enables radiation length manager to estimate radiation length data by default: kFALSE;
 - **FieldSwitcher** To choose the magnetic Field, default option is 0 that corresponds to Constant field (0, 0, 5) kG; option 1, corresponds to the FieldMap stored in a file

**Example:** to analyze 100 events generated with UrQMD you should write:

```ruby
void runMC(EGenerators generator = EGenerators::URQMD, EVMCType vmc = EVMCType::GEANT3, Int_t nStartSeed = 0,
           TString inFile = "auau.04gev.0_3fm.10k.f14.gz", TString outFile = "evetest.root", Int_t nStartEvent = 0,
           Int_t nEvents = 100, Bool_t flag_store_FairRadLenPoint = kFALSE, Int_t FieldSwitcher = 0)
```

## More Settings

### Detector used in transport

Another settings that can be done are: the detectors to be considered for the transport which can be selected on the macro **[geometry_stage1.C](https://git.jinr.ru/nica/mpdroot/-/blob/dev/macros/common/geometry_stage1.C)**.

This macro contains the geometry of: the cave, the pipe, the magnet and detectors which are managed by the FairRunSim class and loaded by the FairModule and FairDetector classes. Each detector to be used, needs to be called; for example for the ECAl detector the following lines should be appear 

```ruby
  FairDetector *Emc = new MpdEmcKI("EMC", kTRUE);
  Emc->SetGeometryFileName("emc_v3.root");
  fRun->AddModule(Emc);
```
Remember to verify the geometry version that you should use, and replace it. Now the current version of the ECAL is v.4, hence change the geometry name *emc_v3.root* by *emc_v4.root*

```ruby
  Emc->SetGeometryFileName("emc_v4.root");
```
and verify that is in your mpdroot installation. Geometry files are stored in the folder [geometry](https://git.jinr.ru/nica/mpdroot/-/tree/dev/geometry).

### Particular options for the generator selected

Some generators include some options to read additional information for example in the PHSD case, that includes polarization or UrQMD that fixes the event plane angle distribution in some particular range.

#### UrQMD

With this generator is posible to choose the uniform distribution of the event plane angle between to values min and max, by default is between 0° to 30° as appears in the line 215 of the macro runMC.C

```ruby
      MpdUrqmdGenerator *urqmdGen = new MpdUrqmdGenerator(inFile);
      // Event plane angle (in degrees) will be generated by uniform distribution from min to max
      Float_t min = 0.0, max = 30.0;
      urqmdGen->SetEventPlane(min * TMath::DegToRad(), max * TMath::DegToRad());
      primGen->AddGenerator(urqmdGen);
```

### Selection of decayer



| [:arrow_left: previous](../generation/generation.md)| [main:arrow_up:](../../README.md) | [next :arrow_right:](../reconstruction/reconstruction.md) |
